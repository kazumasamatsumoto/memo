## WHERE句による絞り込み

* SQLの言語としての特徴
* 命令自体は単純で、数も少ない(主に使う物は4つ)
* しかし、さまざまな修飾語をつけることで、複雑な処理が可能になる。

WHERE句を自由自在に使えて初めて、データを自由自在に操作することができる。

### WHERE句の基本
(1) 処理対象行の絞り込みに用いる
->WHEREを指定しないと「全ての行」が処理対象になる。
(2) SELECT、UPDATE、DELETE文で使用可能
->INSERT文では使用できない
(3) WHEREの後ろには条件式を記述する
->絞り込み条件にそった「正しい条件式」を記述する

### WHERE句に書ける物
結果が必ず真(TRUE)または偽(FALSE)となる条件式

### LIKE演算子
文字列があるパターンに合致しているかをチェックすることを

「パターンマッチング」

という。

「100%」という文字で終わるかを判定したい場合のように、%や_の文字そのものを含む文字列を部分一致検索したいときには、

少し工夫が必要です。

なぜなら、次のようにそのまま記述すると、%は特殊な意味の文字として

扱われてしまうからです。

/* 「100を含む文字列」という意味になる */
SELECT * FROM 家計簿 WHERE メモ LIKE '%100%'

パターン文字列の中で、単なる文字として%や_を使いたい場合、

次のようにESCAPE句を併用した記述を行います。

SELECT * FROM 家計簿 WHERE メモ LIKE '%100$%' ESCAPE '$'

ESCAPE句で指定した文字（上の行では$）はエスケープ文字といい、

パターン文字列において特殊な取り扱いがされるようになります。

この例では、今回のエスケープ文字$に続く%や_は、ただの文字として扱われる。

### BETWEEN演算子による範囲判定
WHERE句のオプションとしてBETWEENが使える

SELECT *
FROM 家計簿
WHERE 出金額 BETWEEN 100 AND 3000

### IN/NOT IN 演算子
IN演算子は、値がカッコ内に列挙した複数の値（値リスト）のいずれかに合致するかを判定する演算子

SELECT *
FROM 家計簿
WHERE 費目 NOT IN ('食費', '交際費')
合致しない

SELECT *
FROM 家計簿
WHERE 費目 IN ('食費', '交際費')
合致する

### ANY/ALL演算子

ANY演算子
どれか以下に合致するなら真

ALL演算子
全てに合致するなら真

## 複数の条件式を組み合わせる

### 論理演算子

* カッコによる優先順位の引き上げ
条件式をカッコで括ると、評価の優先順位が引き上がる

### 主キーとなる列が持つべき特性
* 必ず何らかのデータが格納される(NULLではない)
* 他の行と値が重複しない

「社員番号」が備える特殊な性質
* 社員番号を持たない社員は存在しない
* 同じ社員番号が、異なる社員に割り振られることはない。

入出金IDのように、
管理目的のためだけに人為的に追加された列を、

自然キーに対して人工キー(artificial key)や代替キー(surrogate key)といいます

複数の列を1つの主キーとして扱うものを複合主キー(compound key)といいます。

## まとめ
WHERE句
* WHERE句に記述した条件式によって、対象データを絞り込むことができる
* WHERE句は、SELECT、UPDATE、DELETE文で使うことができる

演算子
* 条件式にはさまざまな演算子を記述できる
比較演算子: =、<、>、<=、>=、<>
IS NULL、LIKE、BETWEEN、IN、ANY、ALL

論理演算子: AND、OR、NOT
・論理演算子は、NOT、AND、ORの順番で優先度が高く先に評価される

NULL
・データが格納されておらず、未定義の状態を「NULLが格納されている」と表現する。
・NULLを判定するための条件式では、IS NULLと IS NOT NULLを使用する
「=NULL」では正しく判定できない。

主キー
・主キーによって、テーブル内の1つ一つのデータが識別可能になる。
・主キーとなる列には、重複しない値が必ず格納される必要がある。
・自然キーが存在しない場合は、人工キーを追加して識別可能にする。
・複数の列を組み合わせて複合主キーを構成し、行を識別するために用いることができる