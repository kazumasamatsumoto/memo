## データとロジックを別のクラスに分けることがわかりにくさを生む

## 業務アプリケーションのコードの見通しが悪くなる原因
従来の手続き型の設計では、

アプリケーションのクラス構成を、

データに格納するデータクラスと、

ロジックを記述する機能クラス（ロジッククラス）

に分けることが基本になります。

<img src="./Images/ProceduralDesignDividedIntoDataClassesAndFunctionalClasses.png">

データクラスは、表のように様々な名前で呼ばれますが「データを格納するためのクラス」

という点で同じものです。

* データクラスのいろいろな呼び方
<img src="./Images/VariousWaysToCallDataClass.png">

データクラスは、getQuantity()/setQuantity()など、いわゆるgetter/setterと呼ばれるメソッド群だけを持ちます。

データを使った判断/加工/計算のロジックは、

機能クラス（ロジッククラス）に記述します。

業務アプリケーションでは、業務ロジックを整理するために、

画面インターフェース/業務ロジック/データベース入出力の3つの関心事を分離するための

三層アーキテクチャが一般的です。

* 三層アーキテクチャ
<img src="./Images/ThreeTieredArchitecture.png">

しかし、三層アーキテクチャを採用しても、

データクラスと機能クラスを分ける手続き型の設計のままでは、

アプリケーションの修正や拡張が必要になった時に以下の状況になりがちです。

* 変更の対象箇所を特定するために、プログラムの広い範囲を調べる
* 一つの変更要求に対して、プログラムのあちこちの修正が必要
* 変更の副作用が起きないことを確認するための大量のテスト

こうなってしまうのは、データクラスと機能クラスを分ける手続き型の設計では、

業務ロジックが入り組んでくると、次の問題が顕著になるからです。

* 同じ業務ロジックがあちこちに重複してかかれる
* どこに業務ロジックが書いてあるか見通しが悪くなる

それぞれの問題について、もう少し具体的に考えてみましょう。

## データクラスを使うと同じロジックがあちこちに重複する
データクラスを使う設計では、ロジックは機能クラスに書きます。

このやり方だと、データクラスを参照できる場所であれば、

どこにでもロジックがかけます。

データクラスを使った業務アプリケーションの構造は次のようになります。

<img src="./Images/PassingDataBetweenThreeLayersUsingDataClass.png">

プレゼンテーション層/アプリケーション層/データソース層は、

同じデータクラスを参照できます。

その結果、そのデータクラスのデータを使うロジックは、

どの層のクラスにも書けてしまいます。

また、同じロジックが異なるクラスに重複して記述されがちです。

三層のどこにでもロジックが書け、

しかもあちこちに業務ロジックが重複すると、

変更が大変になります。

変更の対象箇所を特定するために広い範囲のソースコードを調べる必要があります。

必要な箇所を全て修正し、

変更の副作用がないことを確認するために広い範囲をテストしなければいけません。

そもそもデータクラスと機能クラスに分ける設計は、

「クラス」本来の使い方ではありません。

むしろJavaが言語の仕組みとしてクラスを採用した意図とは正反対の使い方です。

Javaは

「クラスに基づいた、オブジェクト指向の汎用のプログラミング言語」

として開発されました。

クラスはデータとロジックを1つのプログラミング単位にまとめる仕組みです。

データをインスタンス変数として持ち、

そのインスタンス変数を使った判断/加工/計算のロジックを

メソッドに書くのが、クラス本来の使い方です。

しかし、データクラスは判断/加工/計算のロジックを持ちません。

データとロジックを一体にするクラス設計の原理から外れています。

* ロジックを持たないデータクラスの例(悪い例)
```
class DataWithoutLogic {
  String value;

  String getValue() {
    return value;
  }

  void setValue(String value) {
    this.value = value;
  }
}
```

このデータクラスは、Javaの文法的には何も間違っていません。

しかし、オブジェクト指向のクラスの使い方としては、間違っています。

このクラスはデータを格納しているだけです。

データを使った判断/加工/計算のロジックを持っていません。

このようなロジックを持たないクラスは、本来のクラスではありません。

ロジックを持たないデータクラスを使ってデータの受け渡しをすると

コードの重複が起きます。

データクラスを参照できる場所であれば、

どのクラスにでも、ロジックが書けてしまうわけです。

## データクラスを使うと業務ロジックの見通しが悪くなる
