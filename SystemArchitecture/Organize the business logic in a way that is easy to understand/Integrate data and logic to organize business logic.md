## データとロジックを一体にして業務ロジックを整理する

### 業務ロジックを重複させないためにはどう設計すれば良いか

データクラスと機能クラスは「クラス」という仕組みを使っていますが、

実際はデータ構造と処理手順という典型的な手続き型の設計です。

オブジェクト指向では、データとロジックを一つのクラスにまとめます。

そして、それぞれのクラスを独立したプログラミング単位として開発し、テストします。

クラスにデータとそのデータを使う判断/加工/計算のロジックを一緒に書いておけば、

コードの重複をなくせます。

そのクラスを使う側のクラスに同じロジックを書く必要がなくなるからです。

使う側にロジックを書かなくてよくなければ、使う側のクラスのコードがシンプルになります。

その結果、プログラムの見通しがよくなり、修正の対象箇所が少なくなり、

変更の影響を狭い範囲に限定できます。

つまり、変更が楽で安全になるわけです。

クラス設計で大切なことは、使う側のクラスのコードがシンプルになるように

設計することです。

そういうオブジェクト指向らしいクラスを設計するには次の点に気を配ります。

* メソッドをロジックの置き場所にする
* ロジックを、データを持つクラスに移動する
* 使う側のクラスにロジックを書き始めたら設計を見直す
* メソッドを短くして、ロジックの移動をやりやすくする
* メソッドでは必ずインスタンス変数を使う
* クラスが肥大化したら小さく分ける
* パッケージを使ってクラスを整理する

それぞれについてみていきましょう。

### メソッドをロジックの置き場所にする

データクラスがうまくいかないのは、自分が持っているデータをそのまま別のクラスに

渡してしまうからです。

コードを重複させない設計の基本は、

インスタンス変数を返すだけのgetterメソッドを書かないことです。

* データを保持するだけのクラス（悪い例）
```
class Person {
  private String firstName;
  private String lastName;
  ...

  String getFirstName() {
    return firstName; // インスタンス変数をそのまま返す
  }

  String getLastName() {
    return lastName; // インスタンス変数をそのまま返す
  }
}
```

この例のgetFirstName()メソッドとgetLastName()メソッドはインスタンス変数を返すだけです。

何も役に立つことをしていません。

メソッドはもっと役に立つことを実行しなくてはいけません。

メソッドは判断/加工/計算のロジックを実行して初めて役に立つのです。

* メソッドにロジックを持たせる
```
class ParsonName {
  private String firstName;
  private String lastName;

  String fullName() {
    return String.format("%s %s", firstName, lastName);
  }
}
```

fullName()メソッドは、firstNameとlastNameの2つのインスタンス変数を連結して、空白区切りの使命を返します。

このように、インスタンス変数を使って何らかの処理を行うのがメソッドの正しい姿です。

インスタンス変数を使って何らかの処理を行うのがメソッドの正しい姿です。

インスタンス変数を使った加工や計算をしない、

インスタンス変数を返すだけのgetterメソッドは、メソッドの使い方として間違っているのです。

## 業務ロジックをデータを持つクラスに移動する

データを返すだけのgetterメソッドを見つけたら、そのメソッドに何らかの判断/加工/計算をさせることを考えます。

例えば数値データをgetするメソッドを考えてみましょう。

データをgetするクラスでは、そのデータを使って何か計算したいはずです。

その計算ロジックをgetterメソッドを持つクラスに移動します。

そうすると次のことが起きます。

* データを持つ側のクラスにロジック（計算式）が増える
* データをgetしていたクラスからロジック（計算式）が減る
* 使う側のクラスは、データをgetするのではなく、そのデータを使った計算結果を受け取るようになる

こうやってデータを持つクラスに業務ロジックを集めることがコードの重複や散在を防ぐ、

オブジェクト指向の基本です。

データを持つクラスにロジックを移動すればコードの重複をなくせます。

コードの重複がなくなれば、変更の対象箇所をそのクラスに限定できます。

データを持つクラスに判断/加工/計算を任せることができるため、

利用する側のクラスのコードはシンプルになり読みやすくなります。

### 使う側のクラスに業務ロジックを書き始めたら設計を見直す

